<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common::commonHead">

</head>

<body>

<!--新增的模态框-->
<div class="modal fade" id="articleAdddModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">新增文章</h4>
            </div>

            <div class="modal-body">
                <form class="form-horizontal">
                    <div class=" form-group">
                        <label  class=" control-label">文章标题</label>
                        <div >
                            <input type="text" name="title" class="form-control" id="article_update_input" placeholder="title">
                            <span class="help-block"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label  class="control-label">文章简介</label>
                        <div >
                            <input type="text" name="summary" class="form-control" id="summary_update_input" placeholder="最多输入100个字">
                            <span class="help-block"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label  class="control-label">标签类型</label>
                            <div >
                                <input type="text" name="category" class="form-control" id="category_update_input" placeholder="用逗号分隔">
                                <span class="help-block"></span>
                            </div>
                    </div>

                    <div class="form-group">
                        <label  class="control-label">文章内容</label>
                        <div>
                            <textarea class="form-control" rows="8" name="content"></textarea>
                            <span class="help-block"></span>
                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" id="article_update_btn">更新</button>
            </div>
        </div>
    </div>
</div>

<!--删除的模态框-->
<div class="modal fade" tabindex="-1" role="dialog" id="deleteModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">删除博文</h4>
            </div>
            <div class="modal-body">
                <p id="article_delete_name"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-danger confrim-delete">删除</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<section id="container" >
    <!-- **********************************************************************************************************************************************************
    TOP BAR CONTENT & NOTIFICATIONS
    *********************************************************************************************************************************************************** -->
    <!--header start-->
    <header th:replace="common::commonHeader">

    </header>
    <!--header end-->

    <!-- **********************************************************************************************************************************************************
    MAIN SIDEBAR MENU
    *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    <aside th:replace="common::commonAside">

    </aside>
    <!--sidebar end-->

    <!-- **********************************************************************************************************************************************************
    MAIN CONTENT
    *********************************************************************************************************************************************************** -->


    <!--main content start-->
    <section id="main-content">
        <section class="wrapper site-min-height">
            <h3><i class="fa fa-angle-right"></i> Welcome Page</h3>
            <div class="row mt">
                <div class="col-lg-12">
                    <div class="row mt">
                        <div class="col-md-12">
                            <div class="content-panel">
                                <table class="table table-striped table-advance table-hover">
                                        <h4><i class="fa fa-angle-right"></i> 博文列表</h4>
                                        <button class="btn btn-primary" data-toggle="modal" data-target="#articleAdddModal">新增文章</button>
                                    <hr>
                                    <thead>
                                    <tr>
                                        <th><i class="fa fa-bullhorn"></i> ID</th>
                                        <th class="hidden-phone"><i class="fa fa-question-circle"></i> 标题</th>
                                        <th><i class="fa fa-bookmark"></i> 访问量</th>
                                        <th><i class=" fa fa-edit"></i> 置顶</th>
                                        <th></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="article:${articles.list}">
                                        <td th:text="${article.id}">Company Ltd</td>
                                        <td class="hidden-phone" th:text="${article.title}">Lorem Ipsum dolor</td>
                                        <td th:text="${article.traffic}">12000.00$ </td>
                                        <td th:text="${article.isTop}? 'True' : 'False'"><span class="label label-info label-mini">Due</span></td>
                                        <td>
                                            <button class="btn btn-primary btn-xs"><i class="fa fa-pencil"></i></button>
                                            <button class="btn btn-danger btn-xs delete_btn" data-toggle="modal" data-target="#deleteModal" th:id="${article.id}"><i class="fa fa-trash-o "></i></button>
                                        </td>
                                    </tr>

                                    </tbody>
                                </table>
                                <ul class="pagination pagination-right">
                                    <li><a href="#">&laquo;</a></li>
                                    <li><a href="#">1</a></li>
                                    <li><a href="#">2</a></li>
                                    <li><a href="#">3</a></li>
                                    <li><a href="#">4</a></li>
                                    <li><a href="#">5</a></li>
                                    <li><a href="#">&raquo;</a></li>
                                </ul>

                            </div><!-- /content-panel -->
                        </div><!-- /col-md-12 -->
                    </div><!-- /row -->
                </div>
            </div>

        </section><! --/wrapper -->
    </section><!-- /MAIN CONTENT -->

    <!--main content end-->
    <!--footer start-->
    <footer th:replace="common::commonFooter">

    </footer>
    <!--footer end-->
</section>


<!-- js placed at the end of the document so the pages load faster -->
<script src="/static/js/jquery.js"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/jquery-ui-1.9.2.custom.min.js"></script>
<script src="/static/js/jquery.ui.touch-punch.min.js"></script>
<script class="include" type="text/javascript" src="/static/js/jquery.dcjqaccordion.2.7.js"></script>
<script src="/static/js/jquery.scrollTo.min.js"></script>
<script src="/static/js/jquery.nicescroll.js" type="text/javascript"></script>
<!--common script for all pages-->
<script src="/static/js/common-scripts.js"></script>
<script>

/*弹出删除模态框*/
$(".delete_btn").click(function () {
    var btn_id = $(this).attr("id");
    getArticle(btn_id);
    $(".confrim-delete").attr("dele-id",btn_id);
});
/*根据ID获取文章信息*/
function getArticle(id) {
    $.ajax({
        url:"/admin/article/"+id,
        type:"GET",
        success:function (result) {
            $("#article_delete_name").html('是否删除 - '+result.data.title);
        }
    })
}
/*确认删除事件*/
$(".confrim-delete").click(function () {
    var dele_id = $(this).attr("dele-id")
    $.ajax({
        url:"/admin/article/"+dele_id,
        type:"DELETE",
        success:function (result) {
            $("#deleteModal").modal("hide");
            location.reload();
            console.log("删除成功");
        }
    })
})

/*新增博文*/
$("#article_update_btn").click(function () {
    $.ajax({
        url:"/admin/article/add",
        type:"POST",
        data:$("#articleAdddModal form").serialize(),
        success:function (result) {
            //1.关闭模态框
            $("#articleAdddModal").modal("hide");

            location.reload();
        }
    })
})

</script>
<!--script for this page-->


</body>
</html>
